# منطق احتساب الدرجات في نظام تقييم الأداء

يشرح هذا المستند كيفية احتساب الدرجات النهائية للتقييمات الأسبوعية والشهرية في التطبيق.

## نظرة عامة

يعتمد النظام على نوعين من التقييمات، لكل منهما طريقة حساب مختلفة:
1.  **التقييم الأسبوعي:** تقييم سريع ومبسط يعتمد على متوسط مباشر للدرجات.
2.  **التقييم الشهري:** تقييم شامل يعتمد على فئات متعددة وأوزان مختلفة لكل فئة.

---

## 1. منطق حساب التقييم الأسبوعي

يتم حساب درجة التقييم الأسبوعي باستخدام دالة `calculateWeeklyScore` في ملف `src/lib/calculations.ts`.

**الخطوات:**
1.  يتم جمع كل الدرجات (التي تتراوح من 1 إلى 5) التي تم إدخالها في الاستبيان الأسبوعي.
2.  يتم قسمة المجموع على عدد البنود التي تم تقييمها.
3.  النتيجة النهائية هي **متوسط حسابي بسيط** للدرجات، وتتراوح أيضًا من 1 إلى 5.

**مثال:**
-   إذا كانت درجات البنود هي: `[5, 4, 5, 3]`
-   المجموع = `17`
-   عدد البنود = `4`
-   الدرجة النهائية = `17 / 4 = 4.25`

---

## 2. منطق حساب التقييم الشهري

يتم حساب درجة التقييم الشهري باستخدام دالة `calculateMonthlyScore`، وهو أكثر تعقيدًا لأنه يعتمد على فئات وأوزان.

**الفئات والأوزان:**
يتم تقسيم بنود التقييم الشهري إلى أربع فئات رئيسية، ولكل فئة وزن محدد يؤثر على الدرجة النهائية:

| الفئة (Category) | الوزن (Weight) |
| :-------------- | :------------- |
| **فني (Technical)** | 30% |
| **سلوكي (Behavioral)** | 30% |
| **رعاية (Care)** | 30% |
| **مبادرة (Initiative)** | 10% |

**خطوات الحساب:**
1.  **حساب متوسط كل فئة:** يتم حساب المتوسط الحسابي للدرجات (من 1 إلى 5) داخل كل فئة من الفئات الأربع بشكل منفصل.
2.  **تطبيق الأوزان:** يتم ضرب متوسط كل فئة في الوزن المخصص لها.
    -   `الدرجة الموزونة للفئة الفنية = متوسط الفئة الفنية * 0.30`
    -   `الدرجة الموزونة للفئة السلوكية = متوسط الفئة السلوكية * 0.30`
    -   `الدرجة الموزونة لفئة الرعاية = متوسط فئة الرعاية * 0.30`
    -   `الدرجة الموزونة لفئة المبادرة = متوسط فئة المبادرة * 0.10`
3.  **جمع الدرجات الموزونة:** يتم جمع كل الدرجات الموزونة للحصول على درجة نهائية (من 1 إلى 5).
4.  **التحويل إلى نسبة مئوية:** يتم تحويل الدرجة النهائية إلى نسبة مئوية عن طريق قسمتها على 5 ثم ضربها في 100.

**مثال:**
-   متوسط الفئة الفنية = `4.5`
-   متوسط الفئة السلوكية = `4.0`
-   متوسط فئة الرعاية = `4.2`
-   متوسط فئة المبادرة = `5.0`

-   الدرجة الموزونة = `(4.5 * 0.3) + (4.0 * 0.3) + (4.2 * 0.3) + (5.0 * 0.1)`
-   الدرجة الموزونة = `1.35 + 1.2 + 1.26 + 0.5 = 4.31` (من 5)
-   النتيجة النهائية (كنسبة مئوية) = `(4.31 / 5) * 100 = 86.2%`

---

## ملاحظات هامة

-   **لا يوجد منطق حسابي مشترك:** لا توجد حاليًا أي عملية حسابية في الكود تدمج بين نتائج التقييمات الأسبوعية والشهرية. يتم التعامل مع كل نوع بشكل مستقل تمامًا.
-   **مصدر البيانات:** تعتمد هذه الحسابات على تعريف البنود وفئاتها في ملف `src/lib/evaluationItems.ts`.
